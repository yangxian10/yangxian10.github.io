<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>杨现的个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="迭代的是人，递归的是神">
<meta property="og:type" content="website">
<meta property="og:title" content="杨现的个人博客">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="杨现的个人博客">
<meta property="og:description" content="迭代的是人，递归的是神">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="杨现的个人博客">
<meta name="twitter:description" content="迭代的是人，递归的是神">
  
    <link rel="alternative" href="/atom.xml" title="杨现的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">杨现的个人博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">分享计算机视觉、算法、生活累积的点滴</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-book-list" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/12/book-list/" class="article-date">
  <time datetime="2016-01-12T13:07:43.000Z" itemprop="datePublished">2016-01-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/study/">study</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/12/book-list/">书单</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="想买的">想买的</h1><h2 id="《Effective_C++中文版》">《Effective C++中文版》</h2><p><img src="http://img13.360buyimg.com/n1/14692/6d94eb5a-75ba-4b73-b38c-e1ceb33532fc.jpg" alt="effective C++"></p>
<h2 id="《numpy攻略》">《numpy攻略》</h2><p><img src="http://img12.360buyimg.com/n1/jfs/t268/69/1040716404/165584/e6ce3de/53f55c58N3719acaa.jpg" alt="numpy攻略"></p>
<h2 id="《Python_Cookbook》">《Python Cookbook》</h2><p><img src="http://img11.360buyimg.com/n1/jfs/t1210/198/742186232/357507/4f64f545/55407ebbNc012ae29.jpg" alt="Python Cookbook"></p>
<h1 id="英文版的">英文版的</h1><h2 id="《OpenCV_3_Blueprints》">《OpenCV 3 Blueprints》</h2><p><img src="http://ww3.sinaimg.cn/bmiddle/5396ee05jw1ezcnc1rnnqj205n06ydgk.jpg" alt="OpenCV 3 Blueprints"></p>
<h2 id="《Raspberry_Pi_Computer_Vision_Programming》">《Raspberry Pi Computer Vision Programming》</h2><p><img src="http://ww1.sinaimg.cn/bmiddle/5396ee05gw1eyy009xemuj206807oq3g.jpg" alt="Raspberry Pi Computer Vision Programming"></p>
<h2 id="《Web_Scraping_with_Python_-_Collecting_Data_from_the_Modern_Web》">《Web Scraping with Python - Collecting Data from the Modern Web》</h2><p><img src="http://ww1.sinaimg.cn/bmiddle/5396ee05jw1euxumch0dfj20ai0dv75n.jpg" alt="Web Scraping with Python - Collecting Data from the Modern Web"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/12/book-list/" data-id="ciqkzj5yc0038qcfh2pmsmuv7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/source/">source</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-adusting-parameter" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/06/adusting-parameter/" class="article-date">
  <time datetime="2015-12-06T02:17:08.000Z" itemprop="datePublished">2015-12-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深度学习/">深度学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/06/adusting-parameter/">深度学习调参技巧笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="cnn技巧">cnn技巧</h2><p>南大有个哥们写了一个技巧集合，很不错，推荐给大家<a href="http://lamda.nju.edu.cn/weixs/project/CNNTricks/CNNTricks.html" target="_blank" rel="external">http://lamda.nju.edu.cn/weixs/project/CNNTricks/CNNTricks.html</a></p>
<h2 id="网络训练技巧">网络训练技巧</h2><p>1：准备数据：务必保证有大量、高质量并且带有干净标签的数据，没有如此的数据，学习是不可能的<br>2：预处理：这个不多说，就是0均值和1方差化<br>3：minibatch：建议值128,1最好，但是效率不高，但是千万不要用过大的数值，否则很容易过拟合<br>4：梯度归一化：其实就是计算出来梯度之后，要除以minibatch的数量。这个不多解释<br>5：下面主要集中说下学习率<br>5.1：总的来说是用一个一般的学习率开始，然后逐渐的减小它<br>5.2：一个建议值是0.1，适用于很多NN的问题，一般倾向于小一点。<br>5.3：一个对于调度学习率的建议：如果在验证集上性能不再增加就让学习率除以2或者5，然后继续，学习率会一直变得很小，到最后就可以停止训练了。<br>5.4：很多人用的一个设计学习率的原则就是监测一个比率（每次更新梯度的norm除以当前weight的norm），如果这个比率在10-3附近，如果小于这个值，学习会很慢，如果大于这个值，那么学习很不稳定，由此会带来失败。<br>6：使用验证集，可以知道什么时候开始降低学习率，和什么时候停止训练。<br>7：关于对weight初始化的选择的一些建议：<br>7.1：如果你很懒，直接用0.02*randn(num_params)来初始化，当然别的值你也可以去尝试<br>7.2：如果上面那个不太好使，那么久依次初始化每一个weight矩阵用<code>init_scale / sqrt(layer_width) * randn</code>,init_scale可以被设置为0.1或者1<br>7.3：初始化参数对结果的影响至关重要，要引起重视。<br>7.4：在深度网络中，随机初始化权重，使用SGD的话一般处理的都不好，这是因为初始化的权重太小了。这种情况下对于浅层网络有效，但是当足够深的时候就不行了，因为weight更新的时候，是靠很多weight相乘的，越乘越小，有点类似梯度消失的意思<br>8：如果训练RNN或者LSTM，务必保证gradient的norm被约束在15或者5（前提还是要先归一化gradient），这一点在RNN和LSTM中很重要。<br>9：检查下梯度，如果是你自己计算的梯度。<br>10：如果使用LSTM来解决长时依赖的问题，记得初始化bias的时候要大一点<br>12：尽可能想办法多的扩增训练数据，如果使用的是图像数据，不妨对图像做一点扭转啊之类的，来扩充数据训练集合。<br>13：使用dropout。大的网络使用dropout，小网络使用dropout训练很慢，而且不容易收敛<br>14：评价最终结果的时候，多做几次，然后平均一下他们的结果。</p>
<h2 id="参考资料">参考资料</h2><p><a href="https://www.zhihu.com/question/41631631" target="_blank" rel="external">知乎：你有哪些deep learning（rnn、cnn）调参的经验？</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/06/adusting-parameter/" data-id="ciqkzj5t70000qcfhjy8jsjmj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tricks/">tricks</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-dataset-cv" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/05/dataset-cv/" class="article-date">
  <time datetime="2015-11-05T14:23:30.000Z" itemprop="datePublished">2015-11-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Computer-Vision/">Computer Vision</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/05/dataset-cv/">Computer Vision DataSet资源列表</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>俗话说，“算法为王，数据为后”。巧妇难为无米之炊，可见再优秀的算法也得有数据支持。这篇就用来记录我用过的数据集，以备不时之需。</p>
<h1 id="数据集汇总">数据集汇总</h1><p><a href="http://homepages.inf.ed.ac.uk/rbf/CVonline/Imagedbase.htm" target="_blank" rel="external">http://homepages.inf.ed.ac.uk/rbf/CVonline/Imagedbase.htm</a><br><a href="http://visionandlanguage.net/" target="_blank" rel="external">http://visionandlanguage.net/</a><br><a href="http://riemenschneider.hayko.at/vision/dataset/" target="_blank" rel="external">http://riemenschneider.hayko.at/vision/dataset/</a></p>
<h1 id="物体">物体</h1><h3 id="INSTRE:_for_INSTance-level_object_REtrieval_and_REcognition">INSTRE: for INSTance-level object REtrieval and REcognition</h3><p><a href="http://vipl.ict.ac.cn/isia/instre/" target="_blank" rel="external">http://vipl.ict.ac.cn/isia/instre/</a><br>(中科院计算所)新的图像数据集（共计28,543幅图像，100个类），用于验证实例级对象检索、识别算法及其他机器视觉算法，如检测、不变特征和特征匹配等</p>
<h1 id="LOGO图">LOGO图</h1><h3 id="Dataset:_FlickrLogos-32">Dataset: FlickrLogos-32</h3><p><a href="http://www.multimedia-computing.de/flickrlogos/" target="_blank" rel="external">http://www.multimedia-computing.de/flickrlogos/</a><br>2011年公布的一个数据集，包含32类知名商标品牌的logo。</p>
<h1 id="动植物图像">动植物图像</h1><h3 id="水果FIDS30:_Fruit_Image_Data_set">水果FIDS30: Fruit Image Data set</h3><p><a href="http://www.vicos.si/Downloads/FIDS30" target="_blank" rel="external">http://www.vicos.si/Downloads/FIDS30</a><br>2014年公布的水果图片集，包含971张图片，覆盖30种不同的水果</p>
<h3 id="鲜花102_Category_Flower_Dataset">鲜花102 Category Flower Dataset</h3><p><a href="http://www.robots.ox.ac.uk/~vgg/data/flowers/102/index.html" target="_blank" rel="external">http://www.robots.ox.ac.uk/~vgg/data/flowers/102/index.html</a><br>牛津大学vgg组2009年搞的花卉图片，包含102类花卉8189张图片，对应标签<code>imagelabels.mat</code></p>
<h3 id="植物图像库">植物图像库</h3><p><a href="http://www.plantphoto.cn/" target="_blank" rel="external">http://www.plantphoto.cn/</a><br>收录图片208万幅，1.86万种</p>
<h1 id="人脸">人脸</h1><h3 id="CelebA:_Large-scale_CelebFaces_Attributes_(CelebA)_Dataset">CelebA: Large-scale CelebFaces Attributes (CelebA) Dataset</h3><p><a href="http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html" target="_blank" rel="external">http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html</a><br>香港中文大学组2015年搞的一个最新的目前最大的人脸集，包含10177个人，202599张人脸图片，而且每张图片有5个关键点标注信息以及40个2值属性，属性包括是否带眼睛，是否在笑，是否带帽子，是不是卷发，是否年轻，性别等等，是非常珍贵的人脸数据。</p>
<h3 id="WIDER_FACE:_A_Face_Detection_Benchmark">WIDER FACE: A Face Detection Benchmark</h3><p><a href="http://mmlab.ie.cuhk.edu.hk/projects/WIDERFace/" target="_blank" rel="external">http://mmlab.ie.cuhk.edu.hk/projects/WIDERFace/</a><br>香港中文大学再放大招，2015年11月又推出人脸检测标注数据库，包含32203张图片，393703张人脸。其中50%的测试数据集并没有公开标注信息。</p>
<h1 id="汽车">汽车</h1><h3 id="KITTI_Vision_Benchmark">KITTI Vision Benchmark</h3><p><a href="http://www.cvlibs.net/datasets/kitti/index.php" target="_blank" rel="external">http://www.cvlibs.net/datasets/kitti/index.php</a><br>这个就厉害了，包括车载环境的机动车、非机动车、行人以及车道等多方面的标注信息。用于专业的车辆辅助驾驶的检测算法测评。</p>
<h3 id="CompCars:_The_comprehensive_cars_dataset">CompCars: The comprehensive cars dataset</h3><p><a href="http://mmlab.ie.cuhk.edu.hk/datasets/comp_cars/index.html" target="_blank" rel="external">http://mmlab.ie.cuhk.edu.hk/datasets/comp_cars/index.html</a></p>
<h1 id="图像知识图谱">图像知识图谱</h1><h3 id="Visual_Genome">Visual Genome</h3><p><a href="https://visualgenome.org/" target="_blank" rel="external">https://visualgenome.org/</a><br>100K+图像，400万区域描述，170万图像问答，210万物体，180万的属性和关系，所有都映射到Wordnet Synsets</p>
<h1 id="OCR">OCR</h1><h3 id="COCO-TEXT">COCO-TEXT</h3><p><a href="http://vision.cornell.edu/se3/coco-text/" target="_blank" rel="external">http://vision.cornell.edu/se3/coco-text/</a><br>该数据库含63686张图像，123589个文本区域及标注（位置、手写/印刷等属性、语言、可辨识性、文本）</p>
<h1 id="视频">视频</h1><h3 id="ActivityNet">ActivityNet</h3><p><a href="http://activity-net.org/" target="_blank" rel="external">http://activity-net.org/</a><br>人类活动理解建模，200个类和2万个训练/调试/测试视频</p>
<h3 id="WWW_Crowd">WWW Crowd</h3><p><a href="http://www.ee.cuhk.edu.hk/~jshao/WWWCrowdDataset.html" target="_blank" rel="external">http://www.ee.cuhk.edu.hk/~jshao/WWWCrowdDataset.html</a><br>10000个视频、8257种不同场景、超过800万帧图像。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/05/dataset-cv/" data-id="ciqkzj5xh002aqcfhonrg8dd3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dataset/">dataset</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-dlib-face-detect" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/04/dlib-face-detect/" class="article-date">
  <time datetime="2015-11-04T13:53:46.000Z" itemprop="datePublished">2015-11-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Computer-Vision/">Computer Vision</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/04/dlib-face-detect/">基于dlib的人脸检测</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>dlib的人脸检测模块要比OpenCV的效果好一些，归功于其使用的是HOG特征。</p>
<h2 id="dlib安装">dlib安装</h2><p>在windows下我的环境是vs2013和cmake3.2，cmake版本低了会导致编译失败。下载dlib的zip包，然后解压，然后执行如下，就把c++和python的配置好了。注意其中的CMakeLists.txt文件中的OpenCV宏与新版本的OpenCV不相配，需要改成OpenCV REQUIRED，否则<code>webcam_face_pose_ex</code>这个与摄像头有关的模块不会执行成功。</p>
<pre><code>cd examples
vim CMakeLists.txt
<span class="comment">######</span><span class="comment">######</span><span class="comment">######</span><span class="comment">####[open CMakeList.txt]
# find_package(OpenCV) --&gt;
find_package(OpenCV REQUIRED)
###</span><span class="comment">######</span><span class="comment">######</span><span class="comment">######</span><span class="comment">#[close CMakeList.txt]</span>
mkdir build
cd build
cmake .. -DUSE_AVX_INSTRUCTIONS=ON
cmake --build . --config Release
cd ..<span class="regexp">/../</span>
python setup.py install --<span class="literal">yes</span> USE_AVX_INSTRUCTIONS <span class="comment"># AVX为object detector的加速开关</span>
</code></pre><h2 id="人脸检测demo">人脸检测demo</h2><p>在<code>exmaples/faces</code>文件夹下面新建文件<code>face_detector.py</code>，根据官网例程添加代码：</p>
<pre><code>import sys

import dlib
from skimage import io

detector = dlib.get_frontal_face_detector()
<span class="keyword">win</span> = dlib.image_window()

<span class="keyword">for</span> f <span class="keyword">in</span> sys.argv[1:]:
    <span class="keyword">print</span>(<span class="string">"Processing file: {}"</span>.<span class="keyword">format</span>(f))
    img = io.imread(f)
    # The 1 <span class="keyword">in</span> the second argument indicates that we should upsample the image
    # 1 time.  This will make everything bigger and allow <span class="keyword">us</span> to detect <span class="keyword">more</span>
    # faces.
    dets = detector(img, 1)
    <span class="keyword">print</span>(<span class="string">"Number of faces detected: {}"</span>.<span class="keyword">format</span>(len(dets)))
    <span class="keyword">for</span> i, <span class="keyword">d</span> <span class="keyword">in</span> enumerate(dets):
        <span class="keyword">print</span>(<span class="string">"Detection {}: Left: {} Top: {} Right: {} Bottom: {}"</span>.<span class="keyword">format</span>(
            i, <span class="keyword">d</span>.left(), <span class="keyword">d</span>.top(), <span class="keyword">d</span>.right(), <span class="keyword">d</span>.bottom()))

    <span class="keyword">win</span>.clear_overlay()
    <span class="keyword">win</span>.set_image(img)
    <span class="keyword">win</span>.add_overlay(dets)
    dlib.hit_enter_to_continue()


# Finally, <span class="keyword">if</span> you really want to you can ask the detector to tell you the <span class="keyword">score</span>
# <span class="keyword">for</span> each detection.  The <span class="keyword">score</span> is bigger <span class="keyword">for</span> <span class="keyword">more</span> confident detections.
# Also, the idx tells you <span class="keyword">which</span> of the face sub-detectors matched.  This can be
# used to broadly identify faces <span class="keyword">in</span> different orientations.
<span class="keyword">if</span> (len(sys.argv[1:]) &gt; 0):
    img = io.imread(sys.argv[1])
    dets, scores, idx = detector.<span class="keyword">run</span>(img, 1)
    <span class="keyword">for</span> i, <span class="keyword">d</span> <span class="keyword">in</span> enumerate(dets):
        <span class="keyword">print</span>(<span class="string">"Detection {}, score: {}, face_type:{}"</span>.<span class="keyword">format</span>(
            <span class="keyword">d</span>, scores[i], idx[i]))
</code></pre><p>然后执行如下命令即可看到人脸检测效果：</p>
<pre><code><span class="tag">python</span> <span class="tag">face_detector</span><span class="class">.py</span> *<span class="class">.jpg</span>
</code></pre><h2 id="补充">补充</h2><p>C++环境也是一样的，执行<code>cmake build</code>后在<code>examples/build</code>目录下生成可执行文件<code>face_detection_ex</code>，执行</p>
<pre><code><span class="title">face_detection_ex</span> ../faces/<span class="regexp">*.jpg</span>
</code></pre><p>注意<strong>C++接口要想得到矩形框对应的置信度的话也是可以的，也可以根据置信度设置矩形框筛选的阈值，默认阈值为0</strong>，下面为两种接口的函数声明：</p>
<pre><code><span class="keyword">template</span> &lt;
    <span class="keyword">typename</span> image_type
    &gt;
<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;rectangle&gt; <span class="keyword">operator</span>() (
    <span class="keyword">const</span> image_type&amp; img,
    <span class="keyword">double</span> adjust_threshold = <span class="number">0</span>
);

<span class="keyword">template</span> &lt;
    <span class="keyword">typename</span> image_type
    &gt;
<span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(
    <span class="keyword">const</span> image_type&amp; img,
    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">double</span>, rectangle&gt; &gt;&amp; final_dets,
    <span class="keyword">double</span> adjust_threshold = <span class="number">0</span>
)</span></span>;
</code></pre><h2 id="dlib的人脸关键点检测">dlib的人脸关键点检测</h2><p>下载文件<a href="http://dlib.net/files/shape_predictor_68_face_landmarks.dat.bz2" target="_blank" rel="external">http://dlib.net/files/shape_predictor_68_face_landmarks.dat.bz2</a>解压后将<code>shape_predictor_68_face_landmarks.dat</code>放到<code>examples/build</code>目录，执行</p>
<pre><code><span class="tag">webcam_face_pose_ex</span> <span class="tag">shape_predictor_68_face_landmarks</span><span class="class">.dat</span>
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/04/dlib-face-detect/" data-id="ciqkzj5xh0025qcfhvwooub2m" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/face/">face</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-mxnet-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/09/mxnet-install/" class="article-date">
  <time datetime="2015-10-09T13:13:36.000Z" itemprop="datePublished">2015-10-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深度学习/">深度学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/09/mxnet-install/">mxnet学习（一） mxnet + CentOS 7安装配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>mxnet是最近DMLC那群牛人搞的一个开源的深度学习库，可以看作是cxxnet的升级版本，其中到底的美妙还是慢慢专研感受，话不多说，先跑起来看看。整个学习系列都是参考<a href="http://mxnet.readthedocs.org/en/latest/index.html" target="_blank" rel="external">http://mxnet.readthedocs.org/en/latest/index.html</a>学习完成的。</p>
<h2 id="相关开发环境的配置">相关开发环境的配置</h2><p>系统的检测以及python的安装都是基本的，主要依赖软件是CUDA、intel mkl以及OpenCV的安装配置，具体可以参考之前写的<a href="http://yangxian10.github.io/2015/08/18/caffe-setup2/" target="_blank" rel="external">caffe学习（三）caffe + centOS 7 + CUDA 7配置</a>，已经写的很详细了，这里就不再多言。mxnet不像caffe那样依赖众多的google的工具库，这一点还是必须点赞的（caffe安装坑太多了）</p>
<h2 id="安装mxnet">安装mxnet</h2><pre><code>git clone --recursive http<span class="variable">s:</span>//github.<span class="keyword">com</span>/dmlc/mxnet
<span class="keyword">cd</span> mxnet/<span class="keyword">make</span>
<span class="keyword">cp</span> config.<span class="keyword">mk</span> config.<span class="keyword">mk</span>.bak
<span class="keyword">vim</span> config.<span class="keyword">mk</span>
################# <span class="keyword">open</span>[config.<span class="keyword">mk</span>]
USE_CUDA = <span class="number">1</span>
USE_CUDA_PATH = /usr/local/cuda
USE_BLAS = mkl
USE_INTEL_PATH = /<span class="keyword">opt</span>/intel/
################# <span class="keyword">close</span>[config.<span class="keyword">mk</span>]
<span class="keyword">cd</span> ..
<span class="keyword">make</span> -j4
<span class="keyword">cd</span> <span class="keyword">python</span>
<span class="keyword">python</span> setup.<span class="keyword">py</span> install
<span class="keyword">cd</span> ..
</code></pre><p>测试mxnet是否安装ok</p>
<pre><code><span class="keyword">python</span> example/mnist/mlp.<span class="keyword">py</span>
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/10/09/mxnet-install/" data-id="ciqkzj5wm001iqcfh2wbiygln" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mxnet/">mxnet</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-caffe-fine-tuning" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/09/15/caffe-fine-tuning/" class="article-date">
  <time datetime="2015-09-15T14:10:22.000Z" itemprop="datePublished">2015-09-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深度学习/">深度学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/15/caffe-fine-tuning/">caffe学习（五）fine-tuning已有模型到新数据</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="概述">概述</h2><p>最近试了一个新的数据集，由于每一类别训练数据较少，算法无法收敛。于是尝试使用fine-tuning，利用已有训练模型权重参数适应到新的数据集。</p>
<p>由于我们新的分类器与之前的分类器都采用googLeNet的框架，只是在最后一层由3000个类别增加到60000类，所以需要更改最后一层的参数，把原来的<code>loss3/classifier</code>层改成新名字<code>loss3/classifier/fn</code>，这样由于在原来的模型中找不到这层的名字，这层在训练的时候会用随机变量赋初始值重新训练。</p>
<p>由于原来模型已经收敛，在fine-tuning时候要把<code>base_lr</code>更新学习率降低，同时增加<code>blobs_lr</code>在新的层上，让其他层的参数在新数据来的时候慢点更新，同时让新的层快速学习。同时<code>stepsize</code>参数也适当减少，从而让学习率下降的更快一些。</p>
<h2 id="具体步骤">具体步骤</h2><h3 id="数据准备">数据准备</h3><p>这个没啥好说的，将新的训练数据分为train和valuation集，然后转换成lmdb格式，然后得到其均值文件，准备完毕。</p>
<h3 id="train_val-prototxt">train_val.prototxt</h3><ul>
<li>data-layer里的train和test均值文件和训练数据源要设置正确</li>
<li>loss1/classifier-layer层的name改为<code>loss1/classifier/fn</code>，top参数<code>loss1/classifier/fn</code>，lr_mult参数乘10倍，由原来的1和2改为10和20，num_output改为60000</li>
<li>loss1/loss的softmax层的bottom参数改为<code>loss1/classifier/fn</code></li>
<li>loss1/top-1的accuracy层的bottom参数改为<code>loss1/classifier/fn</code></li>
<li>loss1/top-5的accuracy层的bottom参数改为<code>loss1/classifier/fn</code></li>
<li>上述4个步骤的参数修改同时也要应用到loss2和loss3层中</li>
</ul>
<h3 id="solver-prototxt">solver.prototxt</h3><ul>
<li>将<code>test_initialization</code>这句屏蔽掉</li>
<li>gamma改为0.1</li>
<li>weight_decay改为0.0005</li>
<li>base_lr参数降低10倍，改为0.001，这个改动最为重要</li>
</ul>
<h3 id="deploy-prototxt">deploy.prototxt</h3><ul>
<li>loss3/classifier-layer层的name改为<code>loss1/classifier/fn</code>，top参数<code>loss1/classifier/fn</code>，lr_mult参数乘10倍，由原来的1和2改为10和20，num_output改为60000</li>
<li>prob的softmax层的bottom参数改为<code>loss1/classifier/fn</code></li>
</ul>
<h3 id="调用接口">调用接口</h3><pre><code>../../build/tools/caffe train --solver=solver<span class="class">.prototxt</span> -weights sku3081_googlenet_quick_iter_900000<span class="class">.caffemodel</span> -gpu <span class="number">2</span>
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/09/15/caffe-fine-tuning/" data-id="ciqkzj5yc002zqcfh73myk9ru" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/caffe/">caffe</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-caffe-interface" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/08/23/caffe-interface/" class="article-date">
  <time datetime="2015-08-23T12:28:12.000Z" itemprop="datePublished">2015-08-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深度学习/">深度学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/23/caffe-interface/">caffe学习（四）caffe的接口参数说明</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>caffe接口参数</p>
<h2 id="C接口">C接口</h2><h3 id="train相关参数">train相关参数</h3><ul>
<li>-solver参数（必须有），与<code>solver.prototxt</code>文件一起使用</li>
<li>-snapshot参数（可选），通常用来从之前训练一半的模型<code>xxx.solverstate</code>继续训练使用</li>
<li>-weights参数（选填），与训练好的<code>model.caffemodel</code>一起使用，用来在fine-tuning的时候初始化参数</li>
<li>-gpu参数，用来选择使用GPU，根据<code>nvidia-smi</code>的GPU的ID选择，比如选择第三块GPU就使用<code>-gpu 2</code>的参数，如果想使用所有的GPU一起跑一个程序，就使用<code>-gpu all</code></li>
</ul>
<p>举个例子<br><!-- lang:bash--></p>
<pre><code># train LeNet
caffe train -solver examples<span class="regexp">/mnist/</span>lenet_solver.prototxt
# train on GPU <span class="number">2</span>
caffe train -solver examples<span class="regexp">/mnist/</span>lenet_solver.prototxt -gpu <span class="number">2</span>
# resume training <span class="keyword">from</span> the half-way point snapshot
caffe train -solver examples<span class="regexp">/mnist/</span>lenet_solver.prototxt -snapshot examples<span class="regexp">/mnist/</span>lenet_iter_5000.solverstate
# fine-tune CaffeNet model weights <span class="keyword">for</span> style recognition
caffe train -solver examples<span class="regexp">/finetuning_on_flickr_style/</span>solver.prototxt -weights models<span class="regexp">/bvlc_reference_caffenet/</span>bvlc_reference_caffenet.caffemodel
</code></pre><h3 id="test、time相关参数">test、time相关参数</h3><ul>
<li>-iterations迭代次数，time的时候测试的次数，默认为50次</li>
<li>-model测试时候选择加载的模型，对应<code>train_val.prototxt</code>或者<code>deploy.prototxt</code>一起使用</li>
</ul>
<p>举个例子<br><!-- lang:bash--></p>
<pre><code># score the learned LeNet model on the validation <span class="operator"><span class="keyword">set</span> <span class="keyword">as</span> defined <span class="keyword">in</span> the
# <span class="keyword">model</span> architeture lenet_train_test.prototxt
caffe <span class="keyword">test</span> -<span class="keyword">model</span> examples/mnist/lenet_train_test.prototxt -weights examples/mnist/lenet_iter_10000.caffemodel -gpu <span class="number">0</span> -iterations <span class="number">100</span>
# <span class="keyword">time</span> a <span class="keyword">model</span> architecture <span class="keyword">with</span> the given weights <span class="keyword">on</span> the <span class="keyword">first</span> GPU <span class="keyword">for</span> <span class="number">10</span> iterations
caffe <span class="keyword">time</span> -<span class="keyword">model</span> examples/mnist/lenet_train_test.prototxt -weights examples/mnist/lenet_iter_10000.caffemodel -gpu <span class="number">0</span> -iterations <span class="number">10</span></span>
</code></pre><h3 id="device_query相关参数">device_query相关参数</h3><p>这个模块用来查看多GPU时候的一些显卡相关信息。举例<br><!-- lang:bash--></p>
<pre><code><span class="comment"># query the first device</span>
<span class="title">caffe</span> device_query -gpu <span class="number">0</span>
</code></pre><h2 id="python接口">python接口</h2><p>通过<code>import caffe</code>来加载caffe模块，几个比较重要的模块caffe.Net, caffe.SDGSolver, caffe.io, caffe.draw</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/08/23/caffe-interface/" data-id="ciqkzj5xw002wqcfhlqv6ylgv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/caffe/">caffe</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-caffe-setup2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/08/18/caffe-setup2/" class="article-date">
  <time datetime="2015-08-18T15:22:33.000Z" itemprop="datePublished">2015-08-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深度学习/">深度学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/18/caffe-setup2/">caffe学习（三）caffe + centOS 7 + CUDA 7配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这次全程记录centOS 7 的配置安装过程</p>
<h2 id="开发环境">开发环境</h2><p>虽然它这么好用，安装它可不是一个省心的事，最好的参考资料还是官网安装资料<a href="http://caffe.berkeleyvision.org/installation.html" target="_blank" rel="external">http://caffe.berkeleyvision.org/installation.html</a>，配置之前先查看一下自己的软硬件环境</p>
<h3 id="dns配置">dns配置</h3><p>google之，不多介绍，注意centos 7的dns设置与之前的版本不同</p>
<h3 id="查看显卡">查看显卡</h3><p>我们的显卡是K40（没显卡也能玩caffe）,可以看到是4个k40m显卡。。。。我口水直流(<em>@ο@</em>) </p>
<pre><code>lspci <span class="string">|grep -i nvidia</span>
</code></pre><h3 id="查看linux版本">查看linux版本</h3><p>Linux服务器版本是centOS 7，查看服务器系统版本命令</p>
<pre><code>cat <span class="regexp">/etc/</span>redhat-release
</code></pre><h3 id="安装python">安装python</h3><p>python2.7升级到Anaconda版本<a href="https://3230d63b5fc54e62148e-c95ac804525aac4b6dba79b00b39d1d3.ssl.cf1.rackcdn.com/Anaconda-2.3.0-Linux-x86_64.sh" target="_blank" rel="external">Anaconda-2.3.0-Linux-x86_64.sh</a>下载后直接运行即可，numpy,scipy,scikit-learn等相关软件就都配置好了。记得生效一下环境变量<code>source ~/.bashrc</code>。Anaconda直接把python升级到2.7版本，同时安装好了所有相关依赖包，简直完美啊，解决了python多版本共存的问题，同时一键安装python和相关插件，并且配置好了相关环境变量，同时还是64位版本的python，强烈推荐。</p>
<h3 id="安装cmake">安装cmake</h3><p>再把cmake升级到2.8.12版本，centos 7 的yum只能升级到2.8.11版本</p>
<pre><code><span class="preprocessor"># 先安装依赖</span>
yum install gcc
yum install gcc-c++
<span class="preprocessor"># 下载安装包</span>
tar xvf cmake-<span class="number">2.8</span><span class="number">.12</span><span class="number">.1</span>.tar.gz
cd cmake-<span class="number">2.8</span><span class="number">.12</span><span class="number">.1</span>/
./configure
make
make install
vim /etc/profile
<span class="preprocessor">###########[profile末尾添加]</span>
PATH=/usr/local/cmake/bin:$PATH
<span class="keyword">export</span> PATH
<span class="preprocessor">#############关闭文件</span>
source /etc/profile
<span class="preprocessor">########查看是否安装好</span>
cmake --version
</code></pre><h2 id="安装CUDA和MKL">安装CUDA和MKL</h2><p>这两个商用软件安装相对容易</p>
<h3 id="CUDA_7">CUDA 7</h3><p>下载CUDA 7<a href="https://developer.nvidia.com/cuda-downloads" target="_blank" rel="external">https://developer.nvidia.com/cuda-downloads</a></p>
<pre><code>yum install kernel-devel
init <span class="number">3</span>         <span class="comment"># 关闭GUI</span>
./cuda_7.<span class="number">0.28_</span>linux.run
init <span class="number">5</span>         <span class="comment"># 开启GUI</span>
vim /etc/profile
<span class="comment">#############[profile]</span>
export <span class="constant">PATH</span>=<span class="variable">$PATH</span><span class="symbol">:/usr/local/cuda-</span><span class="number">7.0</span>/bin
export <span class="constant">LD_LIBRARY_PATH</span>=<span class="variable">$LD_LIBRARY_PATH</span><span class="symbol">:/usr/local/cuda-</span><span class="number">7.0</span>/lib64
<span class="comment">#############[close profile]</span>
source /etc/profile
</code></pre><p>PS:目前我只在CentOS 7.0配置成功，在7.1和7.2版本会出现如下错误导致CUDA安装失败这里记录一下网上的解决方案：显卡驱动安装不成功，解决方法，先卸载系统已载入的显卡相关模块，同时指定kernel-source-path的路径，如下</p>
<pre><code>lsmod |grep nouveau <span class="preprocessor"># 发现存在相关模块</span>
modprobe -r nouveau <span class="preprocessor"># 卸载相关模块</span>
./cuda_7<span class="number">.0</span><span class="number">.28</span>_linux.run --kernel-source-path=<span class="string">"/usr/src/kernels/03.10.0-xxxxxx"</span>
</code></pre><p>根据caffe的官方最新提示，CUDA和显卡驱动最好分开安装，不然CUDA自带的显卡驱动不是最近版本，可能使用的时候会出问题，先装显卡驱动，去官网下载<a href="http://www.nvidia.com/download/driverResults.aspx/92135/en-us" target="_blank" rel="external">http://www.nvidia.com/download/driverResults.aspx/92135/en-us</a></p>
<pre><code>vim /<span class="class"><span class="keyword">lib</span>/<span class="title">modprobe</span>.<span class="title">d</span>/<span class="title">dist</span>-<span class="title">blacklist</span>.<span class="title">conf</span></span>
<span class="comment">########################[change]</span>
<span class="comment">#blacklist nvidiafb #注释掉nvidiafb，否则cuda安装报错nvidia.ko</span>
<span class="comment">########################[close]</span>
vim /etc/modprobe.d/blacklist-nouveau.conf
<span class="comment">########################[added]</span>
blacklist nouveau
options nouveau modeset=<span class="number">0</span>
<span class="comment">########################[close]</span>
dracut --force
mv /boot/initramfs-<span class="variable">$(</span>uname -r).img /boot/initramfs-<span class="variable">$(</span>uname -r).img.bak
dracut /boot/initramfs-<span class="variable">$(</span>uname -r).img <span class="variable">$(</span>uname -r)
</code></pre><p>init 3和init 5在最新的centOS里并不生效，取而代之的是graphical.target(5)和multi-user.target(3)。</p>
<pre><code>systemctl <span class="keyword">get</span>-default <span class="comment">#查看运行级别</span>
systemctl <span class="keyword">set</span>-default multi-user.target <span class="comment">#切换为文本模式</span>
reboot
./NVIDIA-XXXX.<span class="command">run</span> <span class="comment">--kernel-source-path=/usr/src/kernels/内核号 -k $(uname -r) #最后面的-k参数是可以解决bug: unable to load the kernel module 'nvidia.ko'</span>
</code></pre><p>接下来，验证CUDA是否安装好</p>
<pre><code>nvcc -V     <span class="comment"># 验证nvidia-CUDA-Toolkit是否安装好</span>
<span class="built_in">cd</span> ~/NVIDIA_CUDA-<span class="number">7.0</span>_Samples
make
<span class="built_in">cd</span> bin/x86_64/linux/release
./deviceQuery
</code></pre><p>从输出的信息就可以判断是否安装好CUDA</p>
<h3 id="intel_MKL">intel MKL</h3><p>下载intel MKL，解压后执行</p>
<pre><code>tar xzvf parallel_studio_xe_2015.tgz
cd parallel_studio_xe_2015
./install.sh
<span class="comment"># 偷偷记录一下自己的序列号SGZG-6NRGK57H</span>
vim /etc/ld.so.conf.d/intel_mkl.conf
<span class="comment">###############[intel_mkl.conf]</span>
/opt/intel/mkl/<span class="class"><span class="keyword">lib</span>/<span class="title">intel64</span></span>
<span class="comment">###############[close intel_mkl.conf]</span>
ldconfig
vim /etc/profile
<span class="comment">############[profile]</span>
export <span class="constant">LD_LIBRARY_PATH</span>=<span class="variable">$LD_LIBRARY_PATH</span><span class="symbol">:/opt/intel/mkl/lib</span> 
<span class="comment"># 或者直接把/opt/intel/mkl/lib copy到/usr/local/lib</span>
<span class="comment">############[close profile]</span>
source /etc/profile
</code></pre><h2 id="依赖库安装">依赖库安装</h2><h3 id="Install_protobuf">Install protobuf</h3><p>protobuf是谷歌开发的一种实现内存外存交换的协议接口，在这个统一的通讯协议下不同开发者可以使用自己喜欢的方式进行模型参数的管理。<br>上网下载protobuf2.6.1版本, anaconda的python对应的依赖包要求protobuf是2.6.1版本，弄错了是不行的。解压后，</p>
<pre><code>yum install autoconf automake libtool
tar xzvf protobuf-2.6.1.tar.gz
cd protobuf-2.6.1
<span class="keyword">.</span>/autogen.sh
<span class="keyword">.</span>/configure
make
make<span class="instruction"> check
</span>make install
</code></pre><p>或者直接<code>pip install protobuf</code>，发现版本刚好也是2.6.1</p>
<h3 id="Install_boost">Install boost</h3><p>anaconda没有包含boost，anaconda要求的boost版本为1.57</p>
<pre><code># download <span class="keyword">boost_1_57_0.tar.bz2
</span><span class="label">tar</span> xvf <span class="keyword">boost_1_57_0.tar.bz2
</span><span class="label">cd</span> <span class="keyword">boost_1_57_0
</span>./<span class="keyword">bootstrap.sh
</span>./<span class="keyword">b2
</span>./<span class="keyword">b2 </span>install
</code></pre><h3 id="Install_leveldb">Install leveldb</h3><pre><code>pip install leveldb
<span class="preprocessor"># git clone https://github.com/google/leveldb.git</span>
<span class="preprocessor"># cd leveldb/</span>
<span class="preprocessor"># make</span>
<span class="preprocessor"># cp -d out-shared/libleveldb* /usr/lib/</span>
<span class="preprocessor"># cp -r include/leveldb/ /usr/local/include</span>
</code></pre><h3 id="Install_snappy">Install snappy</h3><p><code>yum install snappy</code>发现centos7 已经给安装好了</p>
<h3 id="Install_lmdb">Install lmdb</h3><pre><code>pip <span class="keyword">install</span> lmdb
</code></pre><h3 id="Install_hdf5">Install hdf5</h3><p>下载hdf5</p>
<pre><code>tar xvf hdf5-1.8.5-patch1.tar
cd hdf5-1.8.5-patch.tar
<span class="keyword">.</span>/configure --prefix=/opt/hdf5
make
make<span class="instruction"> check
</span>make install
make<span class="instruction"> check-install
</span>vim /etc/profile
<span class="comment">############[profile]</span>
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/hdf5/lib
<span class="comment"># 或者直接把/opt/hdf5/lib copy到/usr/local/lib</span>
<span class="comment">############[close profile]</span>
source /etc/profile
</code></pre><h3 id="其他依赖库">其他依赖库</h3><p>其他依赖库按照官网说法，先试了一遍</p>
<pre><code>yum <span class="keyword">install</span> snappy-devel opencv-devel boost-devel
yum <span class="keyword">install</span> python-devel
yum <span class="keyword">install</span> protobuf-devel leveldb-devel hdf5-devel <span class="comment"># 这几个包不行</span>
yum <span class="keyword">install</span> gflags-devel glog-devel lmdb-devel <span class="comment"># 这几个包也不行</span>
</code></pre><p>关于gflags, glog, lmdb的解决方案，官网给出了</p>
<pre><code># glog
wget http<span class="variable">s:</span>//google-glog.googlecode.<span class="keyword">com</span>/<span class="keyword">files</span>/glog-<span class="number">0.3</span>.<span class="number">3</span>.tar.gz
tar zxvf glog-<span class="number">0.3</span>.<span class="number">3</span>.tar.gz
<span class="keyword">cd</span> glog-<span class="number">0.3</span>.<span class="number">3</span>
./configure
<span class="keyword">make</span> &amp;&amp; <span class="keyword">make</span> install
# gflags
wget http<span class="variable">s:</span>//github.<span class="keyword">com</span>/schuhschuh/gflags/archive/master.zip
unzip master.zip
<span class="keyword">cd</span> gflags-master
<span class="built_in">mkdir</span> build &amp;&amp; <span class="keyword">cd</span> build
export CXXFLAGS=<span class="string">"-fPIC"</span> &amp;&amp; cmake .. &amp;&amp; <span class="keyword">make</span> VERBOSE=<span class="number">1</span>
<span class="keyword">make</span> &amp;&amp; <span class="keyword">make</span> install
# lmdb
git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/LMDB/lmdb
<span class="keyword">cd</span> lmdb/libraries/liblmdb
<span class="keyword">make</span> &amp;&amp; <span class="keyword">make</span> install
</code></pre><p>补充一下，上面的配置有可能编译caffe的时候出现如下报错：<code>error while loading shared libraries: libgflag.so.0</code>，要在gflag的cmake的时候使用如下参数</p>
<pre><code>cmake -DCMAKE_INSTALL_PREFIX=/usr/<span class="keyword">local</span> -DBUILD_SHARED_LIBS=<span class="keyword">ON</span> -DGFLAGS_NAMESPACE=google -<span class="keyword">G</span><span class="string">"Unix Makefiles"</span> ../
</code></pre><p>如果报错为<code>error while loading shared libraries: libglog.so.0</code>，则要增加如下设置</p>
<pre><code>cat /etc/ld<span class="class">.so</span><span class="class">.conf</span>  
echo <span class="string">"/usr/local/lib"</span> &gt;&gt; /etc/ld<span class="class">.so</span><span class="class">.conf</span>
ldconfig
</code></pre><p>但是有几个包是不行的，<code>protobuf-devel</code>, <code>leveldb-devel</code>, <code>hdf5-devel</code>找不到<br>刚才已经下载protobuf, leveldb, hdf5, 暂时先不管这几个devel了</p>
<h2 id="安装OpenCV">安装OpenCV</h2><p>安装了这么多年OpenCV，头一次遇到这么大坑，先尝试了大家推荐的shell一键安装</p>
<pre><code>git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/jayrambhia/Install-OpenCV
<span class="keyword">cd</span> Install-OpenCV-master/RedHat
./opencv_latest.<span class="keyword">sh</span>
</code></pre><p>要注意downloading ippicv_linux_20140513.tgz的时候耗时很久，要耐心等待。<br>但是在编译caffe的时候还是报错，回来重新安装opencv2.4.11</p>
<pre><code>cd ~/opencv
mkdir <span class="operator"><span class="keyword">release</span>
cd <span class="keyword">release</span>
cmake -<span class="keyword">D</span> CMAKE_BUILD_TYPE=<span class="keyword">RELEASE</span> -<span class="keyword">D</span> CMAKE_INSTALL_PREFIX=/usr/<span class="keyword">local</span> -<span class="keyword">D</span> CUDA_GENERATION=Kepler ..
make
sudo make <span class="keyword">install</span></span>
</code></pre><p>执行python模块</p>
<pre><code>yum <span class="keyword">install</span> opencv-python
</code></pre><p>测试python下import cv2检测是否安装成功（自带的python已经配置好opencv，anaconda不能import cv2）,解决办法如下:</p>
<pre><code>cp /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">python2</span>.7/<span class="title">site</span>-<span class="title">packages</span>/<span class="title">cv2</span>.<span class="title">so</span> /<span class="title">root</span>/<span class="title">anaconda</span>/<span class="title">lib</span>/<span class="title">python2</span>.7/<span class="title">site</span>-<span class="title">packages</span></span>
cp /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">python2</span>.7/<span class="title">site</span>-<span class="title">packages</span>/<span class="title">cv</span>.<span class="title">py</span> /<span class="title">root</span>/<span class="title">anaconda</span>/<span class="title">lib</span>/<span class="title">python2</span>.7/</span>
</code></pre><h2 id="安装caffe">安装caffe</h2><p>进入到caffe的工作目录</p>
<pre><code>git clone <span class="symbol">https:</span>/<span class="regexp">/github.com/</span><span class="constant">BVLC</span>/caffe
cd caffe
cp <span class="constant">Makefile</span>.config.example <span class="constant">Makefile</span>.config
vim <span class="constant">Makefile</span>.config
<span class="comment">###############[Makefile.config]</span>
<span class="constant">BLAS</span> <span class="symbol">:</span>= mkl

<span class="constant">PYTHON_INCLUDE</span> <span class="symbol">:</span>= <span class="regexp">/root/anaconda</span><span class="regexp">/include/python</span>2.<span class="number">7</span> \
    /root/anaconda/<span class="class"><span class="keyword">lib</span>/<span class="title">python2</span>.7/<span class="title">site</span>-<span class="title">packages</span>/<span class="title">numpy</span>/<span class="title">core</span>/<span class="title">include</span>/ \</span>
<span class="constant">PYTHON_LIB</span> <span class="symbol">:</span>= <span class="regexp">/root/anaconda</span><span class="regexp">/pkgs/python</span>-<span class="number">2.7</span>.<span class="number">10</span>-<span class="number">0</span>/<span class="class"><span class="keyword">lib</span></span>
<span class="constant">INCLUDE_DIRS</span> <span class="symbol">:</span>= <span class="variable">$(</span><span class="constant">PYTHON_INCLUDE</span>) /usr/local/<span class="keyword">include</span> \
        /opt/hdf5/<span class="keyword">include</span> \
        /opt/intel/mkl/<span class="keyword">include</span> \
<span class="constant">LIBRARY_DIRS</span> <span class="symbol">:</span>= <span class="variable">$(</span><span class="constant">PYTHON_LIB</span>) /usr/local/<span class="class"><span class="keyword">lib</span> /<span class="title">usr</span>/<span class="title">lib</span> \</span>
        /opt/hdf5/<span class="class"><span class="keyword">lib</span> \</span>
        /opt/intel/mkl/<span class="class"><span class="keyword">lib</span> \</span>
<span class="comment">###############[close Makefile.config]</span>
make all -j8
make test -j8
make runtest -j8
</code></pre><p>-j8选项可以提高编译速度，不是必须的，如果在runtest时候一片绿色，没报错，恭喜，说明caffe已经配置好了，可以愉快的使用了。<br>实测solverTest会fail，由于是Test模块，先不理会，估计是caffe的代码版本没统一，不影响使用</p>
<h2 id="测试MNIST">测试MNIST</h2><p>进入到caffe根目录下，执行如下操作</p>
<pre><code>./<span class="keyword">data</span>/mnist/get_mnist.sh               <span class="comment"># 下载minst数据库</span>
./examples/mnist/create_mnist.sh        <span class="comment"># 把数据转成lmdb格式</span>
./examples/mnist/train_lenet.sh         <span class="comment"># 训练mnist</span>
</code></pre><p>从输出结果看到，test集上得到99.2%的正确率，还是很不错的。</p>
<h2 id="其他说明">其他说明</h2><h3 id="pycaffe配置">pycaffe配置</h3><pre><code><span class="built_in">make</span> pycaffe
</code></pre><p>编译成功了，简直酸爽。<br>最后配置一下环境变量,~/.bashrc添加</p>
<pre><code>export PYTHONPATH=/xxxxxxxxx/caffe/python:<span class="variable">$PYTHONPATH</span>
</code></pre><p>python环境下</p>
<pre><code><span class="preprocessor"><span class="keyword">import</span> caffe</span>
</code></pre><p>检测caffe-python是否配置好</p>
<h3 id="cuDNN">cuDNN</h3><pre><code>tar xzvf cudnn-<span class="number">7.0</span>-linux-x64-v3.<span class="number">0</span>-rc.tgz
cd cuda
cp <span class="keyword">include</span>/* <span class="regexp">/usr/local</span><span class="regexp">/cuda/include</span>
cp -d lib64/* <span class="regexp">/usr/local</span><span class="regexp">/cuda/lib</span>64        <span class="comment"># -d 保留link file的属性</span>
</code></pre><p>在caffe根目录的<code>Makefile.config</code>中把<code>USE_CUDNN := 1</code>的屏蔽取消，然后<code>make all</code>即可。</p>
<h2 id="Linux多用户管理">Linux多用户管理</h2><p>为了创建一个用户组，并把工作成员都加到这个组，并提升用户sudo权限，提升权限的时候记住最前面的%非常有用，加上才能对组生效，最后设置组内成员能够相互访问彼此目录</p>
<pre><code>groupadd imgergroup
useradd -g imgergroup imger1
passwd imger1
vim /etc/sudoers
<span class="comment">######</span><span class="comment">######</span><span class="comment">######</span><span class="comment">####[sudoers]
%imgergroup       ALL=(ALL)       ALL
###</span><span class="comment">######</span><span class="comment">######</span><span class="comment">######</span><span class="comment">#[close]</span>
cd /home
chmod -R +r *
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/08/18/caffe-setup2/" data-id="ciqkzj5xw002qqcfh93bexikc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/caffe/">caffe</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-caffe-dataprepare" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/08/15/caffe-dataprepare/" class="article-date">
  <time datetime="2015-08-15T00:12:16.000Z" itemprop="datePublished">2015-08-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深度学习/">深度学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/15/caffe-dataprepare/">caffe学习（二）用自己的数据训练模型</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="数据准备">数据准备</h2><h3 id="整理、去重">整理、去重</h3><p>将图片文件按照类别放入不同的文件夹下面，同时去掉相同文件夹下的相同图片</p>
<h3 id="打tag">打tag</h3><p>将图片数据按8:1:1的比例分成train，val，test三个子集，并产生“文件路径 标签”的标签数据，如下</p>
<pre><code>../data/train_img/<span class="number">104166241</span>/<span class="number">143088862023832744.</span>jpg <span class="number">0</span>
../data/train_img/<span class="number">104166241</span>/<span class="number">143088862023832435.</span>jpg <span class="number">0</span>
../data/train_img/<span class="number">121391188</span>/<span class="number">142096822616212389.</span>jpg <span class="number">1</span>
</code></pre><h3 id="生成lmdb数据库文件">生成lmdb数据库文件</h3><p>copy一份<code>examples/imagenet/create_imagenet.sh</code>文件并修改其中EXAMPLE、DATA、TOOLS、TRAIN_DATA_ROOT、VAL_DATA_ROOT的对应路径，并且修改<code>RESIZE=true</code>，因为我们的训练图片要归一化到256*256，我的修改如下</p>
<pre><code><span class="setting">EXAMPLE=<span class="value">.</span></span>
<span class="setting">DATA=<span class="value">.</span></span>
<span class="setting">TOOLS=<span class="value">../build/tools</span></span>

<span class="setting">TRAIN_DATA_ROOT=<span class="value">./</span></span>
<span class="setting">VAL_DATA_ROOT=<span class="value">./</span></span>

<span class="setting">RESIZE=<span class="value"><span class="keyword">true</span></span></span>
</code></pre><p>最后把其中的脚本语句中的convert_imageset命令中的标签文件改为自己的文件名(train.txt、val.txt)，然后执行</p>
<pre><code>./create_db.<span class="keyword">sh</span>
</code></pre><h3 id="生成均值文件">生成均值文件</h3><p>copy一份<code>examples/imagenet/make_imagenet_mean.sh</code>文件并修改其中的EXAMPLE、DATA、TOOLS路径位置，以及命令compute_image_mean中的训练数据集的路径和保存的均值文件的路径文件名，然后执行</p>
<pre><code>./make_db_mean.<span class="keyword">sh</span>
</code></pre><h2 id="模型参数调整">模型参数调整</h2><p>选择一个模型，这里选择GoogleNet，将models/bvlc_googlenet中的<code>solver.prototxt</code>和<code>train_val.prototxt</code>复制到新文件夹下。</p>
<h3 id="train_val-prototxt文件">train_val.prototxt文件</h3><ul>
<li>修改输入layer中的TRAIN source和TEST中的source到自己的数据库路径</li>
<li>同时注意一下其中的<code>batch_size</code>参数，决定每次迭代送多少图片去训练</li>
<li>googleNet有3个弱分类器，修改3个最终的loss1/classifier层中的<code>num_output</code>为我们样本的实际类别数，imageNet类别为1000</li>
</ul>
<h3 id="solver-prototxt文件">solver.prototxt文件</h3><ul>
<li>test_iter按照caffe官方的推荐，应该满足<strong>batch_size * test_iter = val子集的数据数</strong>，比如有1万张验证集图片，batch_size是50，那么test_iter应该设置为200左右。</li>
<li>test_interval决定多次训练迭代后测试一次，由于googleNet每次迭代较快，设置为2000比较合适，大概半个小时test一次</li>
<li>display参数决定多少次迭代显示一次，由于googleNet每次迭代较快，这里我设置为100</li>
<li>stepsize决定多次次迭代后减少学习率，应该和max_iter最大迭代次数综合考虑</li>
<li>snapshot决定多次次迭代后保存一次模型</li>
<li>snapshot_prefix是保存的模型文件名</li>
<li>solver_mode是用GPU还是CPU<br>其他参数都是模型参数学习的相关参数，决定了模型的初始值和收敛速度，暂时先不调节</li>
</ul>
<h2 id="训练">训练</h2><p>简单，执行</p>
<pre><code>../build/tools/caffe train --<span class="keyword">solver</span><span class="built_in">=</span><span class="keyword">solver</span>.prototxt
</code></pre><p>看到了terminal不停的喷log了，那酸爽，记得看一下log中的test结果，可以看到top-1/top-5的验证结果。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/08/15/caffe-dataprepare/" data-id="ciqkzj5yc0032qcfhnb9595m0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/caffe/">caffe</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-caffe-setup" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/08/01/caffe-setup/" class="article-date">
  <time datetime="2015-08-01T10:56:27.000Z" itemprop="datePublished">2015-08-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/深度学习/">深度学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/01/caffe-setup/">caffe学习（一）caffe + centOS 6.5 + CUDA 6.5配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>caffe应该是当下最火的深度学习开源框架了，其性能强大，每天可以处理60M的图片（K40显卡），测试一张图片只要1ms，而且其模块都已经定义好，不需要写什么代码就能轻松调用，虽然是c++开发的却能很好的支持python，简直不能更赞。</p>
<h2 id="开发环境">开发环境</h2><p>虽然它这么好用，安装它可不是一个省心的事，最好的参考资料还是官网安装资料<a href="http://caffe.berkeleyvision.org/installation.html" target="_blank" rel="external">http://caffe.berkeleyvision.org/installation.html</a>，配置之前先介绍一下自己的软硬件环境</p>
<ul>
<li><strong>显卡K20c</strong>（没显卡也能玩caffe）</li>
<li><strong>Linux服务器版本centOS6.5</strong>（版本有点低，这有点坑，系统自带的python是2.6版本，cmake是2.6版本，这都给安装带来了不便，由于是服务器没得选，只能硬着头皮上了，而且网上多是基于Ubuntu系统的配置，所以更要把安装过程记录一下）</li>
<li><p><strong>python升级到2.7版本，再把cmake升级到2.8版本</strong>，我都是下载的源代码安装的，要注意的是安装好之后还要将原来版本移除掉并<strong>链接到新版本</strong>，如下</p>
<p>  mv /usr/bin/python /usr/bin/python_old<br>  ln -s  /usr/local/bin/python2.7 /usr/bin/python</p>
</li>
<li><p><strong>安装numpy1.9.2版本</strong>，也是官网源代码</p>
</li>
</ul>
<h2 id="安装CUDA和MKL">安装CUDA和MKL</h2><p>我使用的是CUDA 6.5版本，并且通过edu邮箱申请了一个MKL的student版本。这两个都是商业软件，问题比较少，安照网上的资料很容易就配置好了。</p>
<h2 id="依赖库安装">依赖库安装</h2><p>按照官网说法，先试了一遍</p>
<pre><code><span class="label">sudo</span> yum install protobuf-devel leveldb-devel snappy-devel opencv-devel <span class="keyword">boost-devel </span>hdf5-devel
</code></pre><p>但是有几个包是不行的，protobuf-devel, leveldb-devel, hdf5-devel找不到，由于我服务器版本比较低，boost和boost-devel都只有1.41版本，注意要把boost也升级一下。protobuf是谷歌开发的一种实现内存外存交换的协议接口，再这个统一的通讯协议下不同开发者可以使用自己喜欢的方式进行模型参数的管理。</p>
<p>首先先把protobuf, leveldb, hdf5, boost高级版本的tar包下载下来解压并用make和make install安装起来，然后下载其分别对应的devel的rpm安装，并通过rpm命令安装：</p>
<pre><code>rpm -<span class="tag">i</span> xxx.rpm
</code></pre><h2 id="安装OpenCV">安装OpenCV</h2><p>安装了这么多年OpenCV，头一次遇到这么大坑，先尝试了大家推荐的shell一键安装</p>
<pre><code>git https://github.com/ouxinyu/<span class="operator"><span class="keyword">Install</span>-OpenCV-<span class="keyword">master</span>
cd <span class="keyword">Install</span>-OpenCV-<span class="keyword">master</span>/RedHat
./opencv_latest.sh</span>
</code></pre><p>看上去一切很美，但是执行downloading ippicv_linux_20140513.tgz这个文件的时候就怎么都过不去了，没能解决，于是还是乖乖的安装官网的教程去下载了一个OpenCV 2.4.9的tar解压安装，安装过程也是安装OpenCV官方的教程来的，但是由于要使用其中的GPU模块，原本预想很顺利的安装过程出了error，查了资料发现是OpenCV的bug<a href="http://code.opencv.org/issues/3814" target="_blank" rel="external">http://code.opencv.org/issues/3814</a>，拷贝文件<a href="http://code.opencv.org/projects/opencv/repository/revisions/feb74b125d7923c0bc11054b66863e1e9f753141/raw/modules/gpu/src/nvidia/core/NCVPixelOperations.hpp" target="_blank" rel="external">NCVPixelOperations.hpp</a>替换掉源文件，重新build make，搞定</p>
<pre><code>cd ~/opencv
mkdir <span class="operator"><span class="keyword">release</span>
cd <span class="keyword">release</span>
cmake -<span class="keyword">D</span> CMAKE_BUILD_TYPE=<span class="keyword">RELEASE</span> -<span class="keyword">D</span> CMAKE_INSTALL_PREFIX=/usr/<span class="keyword">local</span> ..

cd ..
make
sudo make <span class="keyword">install</span></span>
</code></pre><h2 id="安装caffe">安装caffe</h2><p>复制一个配置文件先</p>
<pre><code><span class="tag">cp</span> <span class="tag">Makefile</span><span class="class">.config</span><span class="class">.example</span> <span class="tag">Makefile</span><span class="class">.config</span>
</code></pre><p>把里面的CPU_ONLY，BLAS，PYTHON_DIR目录都按照情况配置好，然后执行</p>
<pre><code><span class="keyword">make</span> <span class="keyword">all</span> -j8
<span class="keyword">make</span> test -j8
<span class="keyword">make</span> runtest -j8
</code></pre><p>-j8选项可以提高编译速度，不是必须的，如果在runtest时候一片绿色，没报错，恭喜，说明caffe已经配置好了，可以愉快的使用了。</p>
<h2 id="测试MNIST">测试MNIST</h2><p>进入到caffe根目录下，执行如下操作</p>
<pre><code>./<span class="keyword">data</span>/mnist/get_mnist.sh               <span class="comment"># 下载minst数据库</span>
./examples/mnist/create_mnist.sh        <span class="comment"># 把数据转成lmdb格式</span>
./examples/mnist/train_lenet.sh         <span class="comment"># 训练mnist</span>
</code></pre><p>从输出结果看到，test集上得到99.2%的正确率，还是很不错的。</p>
<h2 id="其他说明">其他说明</h2><h3 id="pycaffe配置">pycaffe配置</h3><ul>
<li><p>由于我这里python没配置好，所以make pycaffe没能通过，有待解决。<br>解决方案，下载<a href="https://3230d63b5fc54e62148e-c95ac804525aac4b6dba79b00b39d1d3.ssl.cf1.rackcdn.com/Anaconda-2.3.0-Linux-x86_64.sh" target="_blank" rel="external">Anaconda-2.3.0-Linux-x86_64.sh</a>，下载后运行，<br>直接把python升级到2.7版本，同时安装好了所有相关依赖包，简直完美啊，，解决了python2.6和2.7共存的问题，同时一键安装python和相关插件，并且配置好了相关环境变量，同时还是64位版本的python，强烈推荐。<br>修改Makefile.config中和python相关内容</p>
<p>  PYTHON_INCLUDE := /root/anaconda/include/python2.7 /root/anaconda/lib/python2.7/site-packages/numpy/core/include/<br>  PYTHON_LIB := /root/anaconda/pkgs/python-2.7.10-0/lib<br>  INCLUDE_DIRS := $(PYTHON_INCLUDE) /usr/local/include<br>  LIBRARY_DIRS := $(PYTHON_LIB) /usr/local/lib /usr/lib</p>
</li>
</ul>
<p>执行</p>
<pre><code><span class="built_in">make</span> pycaffe
</code></pre><p>编译成功了，简直酸爽。<br>最后配置一下环境变量</p>
<pre><code>export PYTHONPATH=/root/caffe_test/caffe/python:<span class="variable">$PYTHONPATH</span>
</code></pre><p>python环境下</p>
<pre><code><span class="preprocessor"><span class="keyword">import</span> caffe</span>
</code></pre><p>报错信息</p>
<pre><code>from ._caffe import <span class="constant">Net</span>, <span class="constant">SGDSolver</span>
<span class="constant">ImportError</span><span class="symbol">:</span> /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">libboost_python</span>.<span class="title">so</span>.1.58.0: <span class="title">undefined</span> <span class="title">symbol</span>: <span class="title">PyUnicodeUCS2_FromEncodedObject</span></span>
</code></pre><p>anaconda只差boost没有包含，而是我安装的boost版本1.58跟anaconda要求的1.57版本，重新安装一遍boost 1.57</p>
<pre><code># download <span class="keyword">boost_1_57_0.tar.bz2
</span><span class="label">tar</span> xvf <span class="keyword">boost_1_57_0.tar.bz2
</span><span class="label">cd</span> <span class="keyword">boost_1_57_0
</span>./<span class="keyword">bootstrap.sh
</span>./<span class="keyword">b2
</span>./<span class="keyword">b2 </span>install /usr
</code></pre><p>记得安装完boost一定要<code>yum install boost-devel</code>一下（血和泪的教训）<br>出现新的错误，说no module name google.portobuf，重新安装protobuf和protobuf-devel并没有解决这个问题，上网上重新下载protobuf2.6.1版本，弄错了是不行的。解压后，</p>
<pre><code><span class="keyword">.</span>/autogen.sh
<span class="keyword">.</span>/configure
make
make<span class="instruction"> check
</span>make install
</code></pre><p>出错loading shared libraries: libprotobuf.so.8: cannot open shared object file: No such file or directory，此时应该是连接出错<br>locate libprotobuf.so.9 看下libprotobuf.so.9的确存在/opt/protobuf/lib下面</p>
<pre><code><span class="keyword">cd</span> /etc/ld.<span class="keyword">so</span>.<span class="keyword">conf</span>.<span class="keyword">d</span>/
<span class="keyword">vi</span> protobuf.<span class="keyword">conf</span>   # protobuf.<span class="keyword">conf</span>中只要加入一行： /<span class="keyword">opt</span>/protobuf/lib
ldconfig
</code></pre><p>安装protobuf的python模块</p>
<pre><code><span class="keyword">cd</span> <span class="keyword">python</span>
<span class="keyword">python</span> setup.<span class="keyword">py</span> build
<span class="keyword">python</span> setup.<span class="keyword">py</span> test
<span class="keyword">python</span> setup.<span class="keyword">py</span> install
</code></pre><p>python setup.py build的过程中可能报几个错，然而没关系，我们并不需要所有的protobuf的模块，配置pycaffe最重要的就是注意anaconda和依赖包版本的对应，boost要求1.57版本，protobuf是2.6.1版本，弄错了是不行的。</p>
<ul>
<li>cuDNN的加速模块也没有安装测试一下，有空再配置一下。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/08/01/caffe-setup/" data-id="ciqkzj5xw002tqcfhpiz0y0o2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/caffe/">caffe</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
    </nav>
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Computer-Vision/">Computer Vision</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/life/">life</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/study/">study</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/深度学习/">深度学习</a><span class="category-list-count">17</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark/">Spark</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c-c/">c/c++</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/caffe/">caffe</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/darknet/">darknet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dataset/">dataset</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/face/">face</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/machine-learning/">machine learning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mxnet/">mxnet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nnsearch/">nnsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/source/">source</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tensorflow/">tensorflow</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tricks/">tricks</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/visualization/">visualization</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生活/">生活</a><span class="tag-list-count">5</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Spark/" style="font-size: 10px;">Spark</a> <a href="/tags/c-c/" style="font-size: 10px;">c/c++</a> <a href="/tags/caffe/" style="font-size: 20px;">caffe</a> <a href="/tags/darknet/" style="font-size: 10px;">darknet</a> <a href="/tags/dataset/" style="font-size: 10px;">dataset</a> <a href="/tags/face/" style="font-size: 10px;">face</a> <a href="/tags/machine-learning/" style="font-size: 10px;">machine learning</a> <a href="/tags/mxnet/" style="font-size: 10px;">mxnet</a> <a href="/tags/nnsearch/" style="font-size: 10px;">nnsearch</a> <a href="/tags/python/" style="font-size: 13.33px;">python</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/source/" style="font-size: 10px;">source</a> <a href="/tags/tensorflow/" style="font-size: 20px;">tensorflow</a> <a href="/tags/tricks/" style="font-size: 10px;">tricks</a> <a href="/tags/visualization/" style="font-size: 10px;">visualization</a> <a href="/tags/生活/" style="font-size: 16.67px;">生活</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/07/13/caffe-yolo/">caffe学习（七）caffe-YOLO模型</a>
          </li>
        
          <li>
            <a href="/2016/07/06/guides-japan/">日本攻略</a>
          </li>
        
          <li>
            <a href="/2016/06/22/python-spider/">python爬虫入门笔记</a>
          </li>
        
          <li>
            <a href="/2016/06/14/tensorflow-caffe2tensorflow/">tensorflow学习（七）caffe模型训练结果转换为tensorflow格式</a>
          </li>
        
          <li>
            <a href="/2016/06/13/tensorflow-inception/">tensorflow学习（六）CNN网络Inception</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget tag">
   <h3 class="title">常用链接</h3>
   <ul class="entry">
    <li><a href="http://blog.csdn.net/yang_xian521" title="my CSDN blog">我的CSDN博客</a></li>
    <li><a href="http://www.pythondoc.com/pythontutorial27/index.html" title="pythondoc">Python教程</a></li>
    <li><a href="http://vbird.dic.ksu.edu.tw/linux_basic/linux_basic.php" title="Linuxdoc">Linux教程</a></li> 
   </ul>
</div>
  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Xian Yang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>